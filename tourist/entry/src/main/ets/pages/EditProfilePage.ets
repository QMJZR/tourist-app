// entry/src/main/ets/pages/EditProfilePage.ets

import router from '@ohos.router';
// å¯¼å…¥ç”¨æˆ·ä¿¡æ¯æ¥å£
import { getProfile, updateProfile, UpdateProfileRequest } from "../api/user";

// ç”¨æˆ·ä¿¡æ¯æ¥å£ï¼ˆä¸ProfilePageä¿æŒä¸€è‡´ï¼‰
interface UserData {
  userId: number;
  username: string;
  nickname: string;
  avatar: string;
  points: number;
  checkinCount: number;
  isMerchant: string;
  checkinSpotIds: number[];
  email: string;
}

// ProfileApiResponse æ¥å£
interface ProfileApiResponse {
  code: number;
  msg: string;
  data: UserData;
}

interface GeneratedObjectLiteralInterface_2 {
  nickname: string;
  avatar: string;
  email: string;
}

interface GeneratedObjectLiteralInterface_1 {
  nickname: string;
  avatar: string;
  email: string;
}

@Entry
@Component
export default struct EditProfilePage {
  // é¡µé¢æ ‡é¢˜
  private pageTitle: string = 'ä¿®æ”¹ä¸ªäººä¿¡æ¯';

  // ç”¨æˆ·åŸå§‹ä¿¡æ¯
  @State originalUserInfo: UserData = {
    userId: 0,
    username: '',
    nickname: '',
    avatar: '',
    points: 0,
    checkinCount: 0,
    isMerchant: '0',
    checkinSpotIds: [],
    email: ''
  };

  // ä¿®æ”¹åçš„ç”¨æˆ·ä¿¡æ¯
  @State nickname: string = '';
  @State email: string = '';
  @State avatarUrl: string = '';

  // ç”¨æˆ·åï¼ˆåªè¯»ï¼‰
  @State username: string = '';

  // è¡¨å•éªŒè¯çŠ¶æ€
  @State nicknameValid: boolean = true;
  @State emailValid: boolean = true;
  @State nicknameError: string = '';
  @State emailError: string = '';

  // æ•°æ®åŠ è½½çŠ¶æ€
  @State isLoading: boolean = false;
  @State isError: boolean = false;
  @State errorMessage: string = '';

  // ä¿å­˜çŠ¶æ€
  @State isSaving: boolean = false;

  // è¡¨å•æ˜¯å¦è¢«ä¿®æ”¹
  @State isFormModified: boolean = false;

  // ==================== æ„å»ºæ–¹æ³• ====================

  build() {
    Column() {
      // 1. é¡¶éƒ¨å¯¼èˆªæ 
      this.buildNavigationBar()

      // 2. æ˜¾ç¤ºåŠ è½½çŠ¶æ€
      if (this.isLoading) {
        this.buildLoadingView()
      } else {
        // 3. æ»šåŠ¨å†…å®¹åŒºåŸŸ
        Scroll() {
          Column() {
            // 4. å¤´åƒä¿®æ”¹åŒºåŸŸ
            this.buildAvatarSection()

            // 5. ä¸ªäººä¿¡æ¯è¡¨å•
            this.buildProfileForm()

            // 6. ä¿å­˜æŒ‰é’®
            this.buildSaveButton()

            // 7. åº•éƒ¨å®‰å…¨åŒºåŸŸå ä½
            Row()
              .height(80)
          }
          .width('100%')
        }
        .scrollBar(BarState.Off)
        .width('100%')
        .layoutWeight(1)
      }

      // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
      if (this.isError) {
        this.buildErrorView()
      }

      // ä¿å­˜ä¸­é®ç½©å±‚
      if (this.isSaving) {
        this.buildSavingOverlay()
      }
    }
    .width('100%')
    .height('100%')
    .backgroundColor('#F5F5F5')
  }

  // ==================== æ„å»ºå™¨æ–¹æ³• ====================

  // é¡¶éƒ¨å¯¼èˆªæ  - ä¿®å¤è¿”å›æŒ‰é’®ç‚¹å‡»åŒºåŸŸ
  @Builder
  buildNavigationBar() {
    Column() {
      Row({ space: 12 }) {
        // è¿”å›æŒ‰é’® - å¢å¤§ç‚¹å‡»åŒºåŸŸ
        Column() {
          Text('â†')
            .fontSize(24)
            .fontColor('#007AFF')
        }
        .width(40)
        .height(40)
        .justifyContent(FlexAlign.Center)
        .alignItems(HorizontalAlign.Center)
        .margin({ left: 8 })
        .onClick(() => {
          console.log('ç‚¹å‡»è¿”å›æŒ‰é’®');
          this.onBackClick();
        })

        // æ ‡é¢˜
        Text(this.pageTitle)
          .fontSize(18)
          .fontWeight(FontWeight.Bold)
          .fontColor('#333333')
          .layoutWeight(1)
          .textAlign(TextAlign.Center)

        // å ä½ï¼Œä½¿æ ‡é¢˜å±…ä¸­
        Column() {
          Text('â†')
            .fontSize(24)
            .fontColor('#007AFF')
            .opacity(0)
        }
        .width(40)
        .height(40)
        .margin({ right: 8 })
      }
      .width('100%')
      .height(56)
      .backgroundColor(Color.White)
      .alignItems(VerticalAlign.Center)

      // å¯¼èˆªæ åº•éƒ¨é˜´å½±
      Divider()
        .strokeWidth(0.5)
        .color('#E0E0E0')
    }
  }

  // åŠ è½½è§†å›¾
  @Builder
  buildLoadingView() {
    Column() {
      LoadingProgress()
        .width(40)
        .height(40)
        .color('#007AFF')

      Text('æ­£åœ¨åŠ è½½ç”¨æˆ·ä¿¡æ¯...')
        .fontSize(16)
        .fontColor('#666666')
        .margin({ top: 20 })
    }
    .width('100%')
    .height('100%')
    .justifyContent(FlexAlign.Center)
    .alignItems(HorizontalAlign.Center)
  }

  // é”™è¯¯è§†å›¾
  @Builder
  buildErrorView() {
    Column() {
      Text('åŠ è½½å¤±è´¥')
        .fontSize(16)
        .fontColor('#FF3B30')
        .margin({ bottom: 8 })

      Text(this.errorMessage)
        .fontSize(14)
        .fontColor('#666666')
        .margin({ bottom: 16 })

      Button('é‡è¯•')
        .backgroundColor('#007AFF')
        .fontColor(Color.White)
        .fontSize(14)
        .width(120)
        .height(36)
        .onClick(() => {
          this.loadUserInfo();
        })
    }
    .width('100%')
    .padding(20)
    .backgroundColor('#FFF3F3')
    .borderRadius(12)
    .margin({ top: 10, bottom: 10, left: 15, right: 15 })
  }

  // ä¿å­˜ä¸­é®ç½©å±‚
  @Builder
  buildSavingOverlay() {
    Column() {
      Column() {
        LoadingProgress()
          .width(40)
          .height(40)
          .color('#FFFFFF')

        Text('æ­£åœ¨ä¿å­˜...')
          .fontSize(14)
          .fontColor(Color.White)
          .margin({ top: 12 })
      }
      .padding(30)
      .backgroundColor('#00000080')
      .borderRadius(12)
    }
    .width('100%')
    .height('100%')
    .justifyContent(FlexAlign.Center)
    .alignItems(HorizontalAlign.Center)
    .position({ x: 0, y: 0 })
  }

  // å¤´åƒä¿®æ”¹åŒºåŸŸ
  @Builder
  buildAvatarSection() {
    Column() {
      Text('å¤´åƒ')
        .fontSize(16)
        .fontColor('#333333')
        .fontWeight(FontWeight.Medium)
        .margin({ left: 20, top: 20, bottom: 15 })
        .alignSelf(ItemAlign.Start)

      Column() {
        // å¤´åƒå®¹å™¨
        Column() {
          if (this.avatarUrl && this.avatarUrl !== '') {
            // å¦‚æœæœ‰å¤´åƒURLï¼Œæ˜¾ç¤ºå¤´åƒ
            Image(this.avatarUrl)
              .width(100)
              .height(100)
              .objectFit(ImageFit.Cover)
              .borderRadius(50)
              .border({ width: 3, color: '#FFFFFF' })
          } else {
            // ä½¿ç”¨ä¸ä¸ªäººä¿¡æ¯ç•Œé¢ç›¸åŒçš„é»˜è®¤å¤´åƒ
            Image($r('app.media.startIcon'))
              .width(100)
              .height(100)
              .objectFit(ImageFit.Cover)
              .borderRadius(50)
              .border({ width: 3, color: '#FFFFFF' })
          }

          // æ›´æ¢å¤´åƒæŒ‰é’®
          Column() {
            Text('ğŸ“·')
              .fontSize(18)
          }
          .width(36)
          .height(36)
          .backgroundColor('#007AFF')
          .borderRadius(18)
          .justifyContent(FlexAlign.Center)
          .alignItems(HorizontalAlign.Center)
          .position({ x: 70, y: 70 })
          .onClick(() => {
            this.onChangeAvatarClick();
          })
        }
        .width(100)
        .height(100)

        // æç¤ºæ–‡å­—
        Text('ç‚¹å‡»æ›´æ¢å¤´åƒ')
          .fontSize(14)
          .fontColor('#666666')
          .margin({ top: 12 })
      }
      .width('100%')
      .padding({ top: 30, bottom: 30 })
      .backgroundColor(Color.White)
      .borderRadius(12)
      .justifyContent(FlexAlign.Center)
      .alignItems(HorizontalAlign.Center)
      .margin({ left: 20, right: 20 })
    }
  }

  // ä¸ªäººä¿¡æ¯è¡¨å•
  @Builder
  buildProfileForm() {
    Column() {
      // è¡¨å•æ ‡é¢˜
      Text('åŸºæœ¬ä¿¡æ¯')
        .fontSize(16)
        .fontColor('#333333')
        .fontWeight(FontWeight.Medium)
        .margin({ left: 20, top: 25, bottom: 15 })
        .alignSelf(ItemAlign.Start)

      // è¡¨å•å®¹å™¨
      Column() {
        // 1. æ˜µç§°è¾“å…¥
        this.buildNicknameInput()

        Divider()
          .strokeWidth(0.5)
          .color('#F0F0F0')
          .margin({ left: 20, right: 20 })

        // 2. é‚®ç®±è¾“å…¥
        this.buildEmailInput()

        Divider()
          .strokeWidth(0.5)
          .color('#F0F0F0')
          .margin({ left: 20, right: 20 })

        // 3. ç”¨æˆ·åæ˜¾ç¤ºï¼ˆä¸å¯ä¿®æ”¹ï¼‰
        this.buildUsernameDisplay()
      }
      .backgroundColor(Color.White)
      .borderRadius(12)
      .margin({ left: 20, right: 20 })
      .shadow({ radius: 2, color: '#00000008' })
    }
  }

  // æ˜µç§°è¾“å…¥æ¡†
  @Builder
  buildNicknameInput() {
    Column() {
      Row({ space: 12 }) {
        Text('æ˜µç§°')
          .fontSize(16)
          .fontColor('#333333')
          .width(70)

        TextInput({
          text: this.nickname,
          placeholder: 'è¯·è¾“å…¥æ˜µç§°'
        })
          .layoutWeight(1)
          .height(50)
          .fontSize(16)
          .fontColor('#333333')
          .caretColor('#007AFF')
          .maxLength(20)
          .onChange((value: string) => {
            this.onNicknameChange(value);
          })
      }
      .width('100%')
      .height(56)
      .padding({ left: 20, right: 20 })

      // æ˜µç§°é”™è¯¯æç¤º
      if (!this.nicknameValid && this.nicknameError) {
        Text(this.nicknameError)
          .fontSize(12)
          .fontColor('#FF3B30')
          .margin({ left: 20, top: 4, bottom: 8 })
          .alignSelf(ItemAlign.Start)
      }
    }
  }

  // é‚®ç®±è¾“å…¥æ¡†
  @Builder
  buildEmailInput() {
    Column() {
      Row({ space: 12 }) {
        Text('é‚®ç®±')
          .fontSize(16)
          .fontColor('#333333')
          .width(70)

        TextInput({
          text: this.email,
          placeholder: 'è¯·è¾“å…¥é‚®ç®±åœ°å€'
        })
          .layoutWeight(1)
          .height(50)
          .fontSize(16)
          .fontColor('#333333')
          .caretColor('#007AFF')
          .type(InputType.Normal)
          .onChange((value: string) => {
            this.onEmailChange(value);
          })
      }
      .width('100%')
      .height(56)
      .padding({ left: 20, right: 20 })

      // é‚®ç®±é”™è¯¯æç¤º
      if (!this.emailValid && this.emailError) {
        Text(this.emailError)
          .fontSize(12)
          .fontColor('#FF3B30')
          .margin({ left: 20, top: 4, bottom: 8 })
          .alignSelf(ItemAlign.Start)
      }
    }
  }

  // ç”¨æˆ·åæ˜¾ç¤ºï¼ˆä¸å¯ä¿®æ”¹ï¼‰
  @Builder
  buildUsernameDisplay() {
    Row({ space: 12 }) {
      Text('ç”¨æˆ·å')
        .fontSize(16)
        .fontColor('#333333')
        .width(70)

      Text(this.username || 'æœªè®¾ç½®')
        .layoutWeight(1)
        .height(50)
        .fontSize(16)
        .fontColor('#666666')
        .textAlign(TextAlign.Start)
        .align(Alignment.Start)
    }
    .width('100%')
    .height(56)
    .padding({ left: 20, right: 20 })
  }

  // ä¿å­˜æŒ‰é’® - ä¿®å¤æŒ‰é’®ç»“æ„
  @Builder
  buildSaveButton() {
    Column() {
      Button() {
        Text('ä¿å­˜ä¿®æ”¹')
          .fontSize(16)
          .fontColor(Color.White)
      }
      .width('90%')
      .height(50)
      .backgroundColor(this.isFormModified && this.isFormValid() ? '#007AFF' : '#CCCCCC')
      .enabled(this.isFormModified && this.isFormValid() && !this.isSaving)
      .onClick(() => {
        this.onSaveClick();
      })
      .margin({ top: 30, bottom: 10 })
    }
    .width('100%')
    .alignItems(HorizontalAlign.Center)
  }

  // ==================== äº‹ä»¶å¤„ç†æ–¹æ³• ====================

  // è¿”å›æŒ‰é’®ç‚¹å‡»
  private onBackClick() {
    console.log('ç‚¹å‡»è¿”å›æŒ‰é’®');

    // å¦‚æœè¡¨å•æœ‰ä¿®æ”¹ï¼Œå¯ä»¥æ·»åŠ ç¡®è®¤æç¤º
    if (this.isFormModified && !this.isSaving) {
      console.log('è¡¨å•æœ‰æœªä¿å­˜çš„ä¿®æ”¹ï¼Œç‚¹å‡»è¿”å›å°†ä¸¢å¤±ä¿®æ”¹');
    }

    // ä½¿ç”¨routerè¿”å›
    router.back();
  }

  // æ›´æ¢å¤´åƒç‚¹å‡»
  private onChangeAvatarClick() {
    console.log('ç‚¹å‡»æ›´æ¢å¤´åƒ');

    // æ¨¡æ‹Ÿå¤´åƒé€‰æ‹©
    const testAvatarUrl = 'https://avatars.githubusercontent.com/u/1?v=4';
    this.avatarUrl = testAvatarUrl;
    this.checkFormModified();
    console.log('å¤´åƒå·²æ›´æ–°:', testAvatarUrl);
  }

  // æ˜µç§°å˜æ›´
  private onNicknameChange(value: string) {
    console.log('æ˜µç§°å˜æ›´:', value);
    this.nickname = value;
    this.validateNickname(value);
    this.checkFormModified();
  }

  // é‚®ç®±å˜æ›´
  private onEmailChange(value: string) {
    console.log('é‚®ç®±å˜æ›´:', value);
    this.email = value;
    this.validateEmail(value);
    this.checkFormModified();
  }

  /// ä¿å­˜æŒ‰é’®ç‚¹å‡»
  private async onSaveClick() {
    console.log('ç‚¹å‡»ä¿å­˜æŒ‰é’®');

    // éªŒè¯è¡¨å•
    if (!this.isFormValid()) {
      console.log('è¡¨å•éªŒè¯å¤±è´¥');
      return;
    }

    // å¦‚æœæ²¡æœ‰ä¿®æ”¹ï¼Œç›´æ¥è¿”å›
    if (!this.isFormModified) {
      console.log('æ²¡æœ‰ä¿®æ”¹ä»»ä½•ä¿¡æ¯');
      router.back();
      return;
    }

    // è®¾ç½®ä¿å­˜çŠ¶æ€
    this.isSaving = true;

    try {
      // æ„å»ºæ›´æ–°æ•°æ®
      const updateData = new UpdateProfileRequest();
      updateData.nickname = this.nickname;
      updateData.email = this.email;
      updateData.avatar = this.avatarUrl;

      console.log('æäº¤çš„ç”¨æˆ·ä¿¡æ¯:', updateData);

      // è°ƒç”¨æ›´æ–°æ¥å£
      const result = await updateProfile(updateData);

      // é¦–å…ˆæ£€æŸ¥ result æ˜¯å¦å­˜åœ¨
      if (!result) {
        console.log('ä¿®æ”¹ä¸ªäººä¿¡æ¯å¤±è´¥: è¿”å›ç©ºå“åº”');
        this.isSaving = false;
        return;
      }

      // ç°åœ¨æˆ‘ä»¬çŸ¥é“ result æ˜¯ UpdateProfileApiResponse ç±»å‹
      if (result.code === 200) {
        console.log('ä¿®æ”¹ä¸ªäººä¿¡æ¯æˆåŠŸ:', result.msg);
        console.log('æ›´æ–°åçš„ç”¨æˆ·æ•°æ®:', result.data);

        // å»¶è¿Ÿåè¿”å›
        setTimeout(() => {
          this.isSaving = false;
          router.back();
        }, 500);
      } else {
        console.log('ä¿®æ”¹ä¸ªäººä¿¡æ¯å¤±è´¥:', result.msg || 'æœªçŸ¥é”™è¯¯');
        this.isSaving = false;
        // è¿™é‡Œå¯ä»¥æ·»åŠ é”™è¯¯æç¤º
      }
    } catch (error) {
      console.error('ä¿å­˜ç”¨æˆ·ä¿¡æ¯å¼‚å¸¸:', error);
      this.isSaving = false;
    }
  }

  // ==================== è¡¨å•éªŒè¯æ–¹æ³• ====================

  // éªŒè¯æ˜µç§°
  private validateNickname(nickname: string) {
    if (!nickname || nickname.trim() === '') {
      this.nicknameValid = false;
      this.nicknameError = 'æ˜µç§°ä¸èƒ½ä¸ºç©º';
      return;
    }

    if (nickname.length < 2) {
      this.nicknameValid = false;
      this.nicknameError = 'æ˜µç§°è‡³å°‘2ä¸ªå­—ç¬¦';
      return;
    }

    if (nickname.length > 20) {
      this.nicknameValid = false;
      this.nicknameError = 'æ˜µç§°ä¸èƒ½è¶…è¿‡20ä¸ªå­—ç¬¦';
      return;
    }

    this.nicknameValid = true;
    this.nicknameError = '';
  }

  // éªŒè¯é‚®ç®±
  private validateEmail(email: string) {
    if (!email || email.trim() === '') {
      this.emailValid = false;
      this.emailError = 'é‚®ç®±ä¸èƒ½ä¸ºç©º';
      return;
    }

    // ç®€å•çš„é‚®ç®±æ ¼å¼éªŒè¯
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(email)) {
      this.emailValid = false;
      this.emailError = 'é‚®ç®±æ ¼å¼ä¸æ­£ç¡®';
      return;
    }

    this.emailValid = true;
    this.emailError = '';
  }

  // æ£€æŸ¥è¡¨å•æ˜¯å¦æœ‰æ•ˆ
  private isFormValid(): boolean {
    return this.nicknameValid && this.emailValid;
  }

  // æ£€æŸ¥è¡¨å•æ˜¯å¦è¢«ä¿®æ”¹
  private checkFormModified() {
    const original: GeneratedObjectLiteralInterface_1 = {
      nickname: this.originalUserInfo.nickname,
      avatar: this.originalUserInfo.avatar,
      email: this.originalUserInfo.email
    };

    const current: GeneratedObjectLiteralInterface_2 = {
      nickname: this.nickname,
      avatar: this.avatarUrl,
      email: this.email
    };

    this.isFormModified =
      original.nickname !== current.nickname ||
        original.avatar !== current.avatar ||
        original.email !== current.email;

    console.log('è¡¨å•ä¿®æ”¹çŠ¶æ€:', this.isFormModified);
  }

  // ==================== æ•°æ®åŠ è½½æ–¹æ³• ====================

  // åŠ è½½ç”¨æˆ·ä¿¡æ¯
  private loadUserInfo() {
    console.log('å¼€å§‹åŠ è½½ç”¨æˆ·ä¿¡æ¯...');

    // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
    this.isLoading = true;
    this.isError = false;
    this.errorMessage = '';

    // è°ƒç”¨ getProfile æ–¹æ³•
    getProfile().then((response) => {
      console.log('è·å–ç”¨æˆ·èµ„æ–™APIå“åº”:', response);

      if (response) {
        // å¦‚æœè·å–æˆåŠŸï¼Œæ›´æ–°ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤º
        if (response.code === 200 && response.data) {
          const userData = response.data;

          console.log('æœåŠ¡å™¨è¿”å›çš„ç”¨æˆ·æ•°æ®:', userData);

          // ä¿å­˜ç”¨æˆ·å
          this.username = userData.username || '';

          // ç¡®å®šæ˜¾ç¤ºæ˜µç§°ï¼šå¦‚æœæ˜µç§°ä¸ºç©ºï¼Œä½¿ç”¨ç”¨æˆ·å
          let displayNickname = userData.nickname;
          if (!displayNickname || displayNickname.trim() === '') {
            displayNickname = this.username || 'æ—…è¡Œçˆ±å¥½è€…';
          }

          // ä¿å­˜åŸå§‹ç”¨æˆ·ä¿¡æ¯
          this.originalUserInfo = {
            userId: userData.userId || 0,
            username: userData.username || '',
            nickname: displayNickname,
            avatar: userData.avatar || '',
            points: userData.points || 0,
            checkinCount: userData.checkinCount || 0,
            isMerchant: userData.isMerchant || '0',
            checkinSpotIds: userData.checkinSpotIds || [],
            email: userData.email || ''
          };

          // è®¾ç½®å½“å‰è¡¨å•æ•°æ®
          this.nickname = displayNickname;
          this.email = userData.email || '';
          this.avatarUrl = userData.avatar || '';

          // éªŒè¯åˆå§‹æ•°æ®
          this.validateNickname(this.nickname);
          this.validateEmail(this.email);

          console.log('ç”¨æˆ·ä¿¡æ¯åŠ è½½å®Œæˆ');
          console.log('åŸå§‹ä¿¡æ¯:', this.originalUserInfo);
          console.log('è¡¨å•æ•°æ®:', {
            nickname: this.nickname,
            email: this.email,
            avatarUrl: this.avatarUrl
          });
        } else {
          console.log('è·å–ç”¨æˆ·èµ„æ–™å¤±è´¥ï¼ŒæœåŠ¡å™¨è¿”å›é”™è¯¯:', response.msg || 'æœªçŸ¥é”™è¯¯');
          this.isError = true;
          this.errorMessage = response.msg || 'æœåŠ¡å™¨è¿”å›é”™è¯¯';
        }
      } else {
        console.log('è·å–ç”¨æˆ·èµ„æ–™å¤±è´¥: è¿”å›ç©ºå“åº”');
        this.isError = true;
        this.errorMessage = 'æœåŠ¡å™¨è¿”å›ç©ºå“åº”';
      }
    }).catch((error: Error) => {
      console.error('è·å–ç”¨æˆ·èµ„æ–™å¼‚å¸¸:', error);
      this.isError = true;
      this.errorMessage = error.message || 'ç½‘ç»œè¯·æ±‚å¤±è´¥';
    }).finally(() => {
      // éšè—åŠ è½½çŠ¶æ€
      this.isLoading = false;
      console.log('åŠ è½½ç”¨æˆ·ä¿¡æ¯å®Œæˆ');
    });
  }

  // ==================== ç”Ÿå‘½å‘¨æœŸæ–¹æ³• ====================

  aboutToAppear() {
    console.log('ä¿®æ”¹ä¸ªäººä¿¡æ¯é¡µé¢æ˜¾ç¤º');
    this.loadUserInfo();
  }

  aboutToDisappear() {
    console.log('ä¿®æ”¹ä¸ªäººä¿¡æ¯é¡µé¢éšè—');
  }
}